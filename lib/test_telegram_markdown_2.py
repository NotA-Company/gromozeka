#!/usr/bin/env python3
"""
Test script for Telegram MarkdownV2 conversion and validation functions.
"""

from telegram_markdown import convertMarkdownToV2, validateMarkdownV2, isValidMarkdownV2

def test_complex_cases():
    """Test complex real-world cases."""
    print("\n=== COMPLEX CASES ===")
    
    complex_md = """
**Суммаризация пользовательских сообщений:**

- **Время начала обсуждения:** 15 сентября 2025 года, 21:39:44 (UTC)  
- **Время окончания обсуждения:** 15 сентября 2025 года, 22:17:10 (UTC)  
- **Участники обсуждения:** пользователь **X** и бот **bot**

---

### **Краткое содержание:**

Обсуждение в указанном временном промежутке сосредоточено на тестировании форматирования текста ботом bot.

1. **Определение даты и времени (21:39–21:40):**  
   Бот, отвечая на неявный запрос, выполняет расчёт и сообщает:
   - Текущая дата — **15 сентября 2025 года**
   - День недели — **понедельник**
   - До Нового года — **107 дней**

2. **Запросы на отправку форматированного текста (22:11–22:17):**  
   Пользователь X дважды (в 22:11 и 22:12) просит бота отправить текст:  
   `Bold (text in braces)`  
   Бот корректно воспроизводит текст без форматирования в первом случае.

   Затем, в 22:17, X отправляет запрос с явным указанием Markdown-разметки в кодовом блоке:
   ```
   **Bold** (text in braces)
   ```
   Бот отвечает тем же текстом, но **применяет жирное начертание**, интерпретируя Markdown, и выводит:  
   **Bold** (text in braces)

---

### **Характер взаимодействия:**

- **Цель пользователя:** Тестирование способности бота обрабатывать и отображать форматированный текст, в частности — поддержку синтаксиса Markdown.
- **Поведение бота:** Корректно реагирует на запросы, демонстрируя понимание разметки при наличии контекста (в кодовом блоке), хотя в первых попытках форматирование не применял.

---

### **Вывод:**

Краткая сессия 15 сентября 2025 года завершает более длительное взаимодействие между X и bot. Пользователь переходит от содержательных и провокационных вопросов к техническому тестированию — проверке обработки текстового форматирования. Бот демонстрирует адекватную реакцию, корректно интерпретируя Markdown при явном указании, что свидетельствует о поддержке разметки в ответах.
"""
    
    print("Complex Markdown input:")
    print(complex_md)
    print("\nConverted to MarkdownV2:")
    converted = convertMarkdownToV2(complex_md)
    print(converted)
    
    print(f"\nValidation result: {isValidMarkdownV2(converted)}")
    is_valid, errors = validateMarkdownV2(converted)
    if not is_valid:
        print("Validation errors:")
        for error in errors:
            print(f"  - {error}")

if __name__ == "__main__":
    test_complex_cases()