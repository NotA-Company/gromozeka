[application]
root-dir = "storage"
[bot]
# bot mode: "telegram" or "max"
mode = "telegram"
# Your Telegram bot token from @BotFather
token = "YOUR_BOT_TOKEN_HERE"
bot_owners = ["YOUR_BOT_OWNER_USERNAME_OR_USER_ID_HERE"]

# Salt for signing [not]spam buttons to reject those actions on random messages
spam-button-salt = "YOUR_SALT_HERE"

[database]
default = "default"

[database.sources.default]
path = "bot_data.db"
readonly = false
pool-size = 5
timeout = 30

# [ratelimiter]
[ratelimiter.ratelimiters.default]
type = "SlidingWindow"
[ratelimiter.ratelimiters.default.config]
windowSeconds = 5
maxRequests = 5

[ratelimiter.ratelimiters.one-per-second]
type = "SlidingWindow"
[ratelimiter.ratelimiters.one-per-second.config]
windowSeconds = 1
maxRequests = 1

[ratelimiter.queues]
yandex-search = "default"
openweathermap = "default"
geocode-maps = "one-per-second" # Free Tier has a limit of 1-5 requests per second

[models.json-logging]
# Log LLM request:responce into JSON format for debugging purposes
enabled = false
file = "logs/llm-json-logging.log"
add-date-suffix = true

[logging]
# Logging configuration
level = "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
format = "%(asctime)s - %(levelname)s - %(name)s - %(message)s"
console = true
# Optional: log to file (uncomment to enable)
file = "logs/gromozeka.log"
error-file = "logs/gromozeka.err.log"
rotate = true

[logging.logger."openai._base_client"]
propagate = false
format = "%(asctime)s - %(levelname)s - %(name)s - %(message)s"
console = true
console-level = "INFO"
file = "logs/openai.log"
file-level = "DEBUG"
rotate = true


[openweathermap]
enabled = false
# OpenWeatherMap API key from https://openweathermap.org/api
api-key = "YOUR_OPENWEATHERMAP_API_KEY"

# Cache time-to-live in seconds
geocoding-cache-ttl = 2592000  # 30 days (coordinates rarely change)
weather-cache-ttl = 3600       # 60 minutes (weather updates frequently)

# API request timeout in seconds
request-timeout = 10

# Default language for location names (ru, en, etc.)
default-language = "ru"

ratelimiter-queue = "openweathermap"

[geocode-maps]
# Geocode Maps API api-key from https://geocode.maps.co/
# If enabled, will be used for geocoding instead of OpenWeatherMap one
enabled = false
# Geocoding API key from https://geocode.maps.co/
api-key = "YOUR_GEOCODING_API_KEY"

cache-ttl = 2592000  # 60 * 60 * 24 * 30 = 30 days (coordinates rarely change)
request-timeout = 30
ratelimiter-queue = "geocode-maps"
accept-language = "ru"


[yandex-search]
enabled = false
# Yandex Cloud credentials for Search API
api-key = "YOUR_YANDEX_SEARCH_API_KEY"
folder-id = "YOUR_YANDEX_FOLDER_ID"

# Cache time-to-live in seconds
cache-ttl = 86400  # 60 * 60 * 24 = 1 day (Search results shouldn't change often)

# API request timeout in seconds
request-timeout = 30

dump-full-xml = false     # If we need to dump whole XML in xml_parser debug logging 
ratelimiter-queue = "yandex-search"

# Default search parameters. Will be passed to search as `**kwargs`
[yandex-search.defaults]
# By default empty, use client defaults
#searchType = "SEARCH_TYPE_RU"
#familyMode = "FAMILY_MODE_MODERATE"
#page = 0
#fixTypoMode = "FIX_TYPO_MODE_ON"
#sortMode = "SORT_MODE_BY_RELEVANCE"
#sortOrder = "SORT_ORDER_DESC"
#groupMode = "GROUP_MODE_DEEP"
#groupsOnPage = 5
#docsInGroup = 2
#maxPassages = 2
#region = "225"  # Russia. See https://yandex.cloud/ru/docs/search-api/reference/regions for examples
#l10n = "LOCALIZATION_RU"
#useCache = true
